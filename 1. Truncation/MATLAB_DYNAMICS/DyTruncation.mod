var
r w Z A K GDP u I C Cb W TT 
rt wt Zt Kt GDPt ut It Ct Cbt Wt 
a1 at1 c1 a2 at2 c2 a3 at3 c3 a4 at4 c4 a5 at5 c5 a6 at6 c6 a7 at7 c7 a8 at8 c8 a9 at9 c9 a10 at10 c10 
a11 at11 c11 a12 at12 c12 a13 at13 c13 a14 at14 c14 a15 at15 c15 a16 at16 c16 a17 at17 c17 ; 

varexo eps; 

parameters
beta alpha abar delta gamma rho_u coef coef2;

alpha   = 0.36;
beta    = 0.98;
abar   = 4.0945e-05;
delta   = 0.025;
gamma   = 1.0001;
rho_u   = 0.95;
coef  = 1.0;
coef2  = 1.;
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

model;

c1 = 0.18103865*w + (1+r)*at1-a1+ TT; % equation 1
at1 = 10^-10 + 0.98071024*a1(-1)+ 0.01928976*a2(-1); % equation 2
a1 =  steady_state(a1); % equation 3
c2 = 0.18103865*w + (1+r)*at2-a2+ TT; % equation 4
at2 = 10^-10 + 0.00475259*a3(-1)+ 0.98078000*a4(-1)+ 0.01439730*a5(-1)+ 0.00007011*a6(-1); % equation 5
a2 =  steady_state(a2); % equation 6
c3 = 0.37416718*w + (1+r)*at3-a3+ TT; % equation 7
at3 = 10^-10 + 0.98071024*a1(-1)+ 0.01928976*a2(-1); % equation 8
a3 =  steady_state(a3); % equation 9
c4 = 0.37416718*w + (1+r)*at4-a4+ TT; % equation 10
at4 = 10^-10 + 0.00475259*a3(-1)+ 0.98078000*a4(-1)+ 0.01439730*a5(-1)+ 0.00007011*a6(-1); % equation 11
0.53634037*(c4 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00478739*(c2(+1))^-gamma+ 0.52603191*(c4(+1))^-gamma+ 0.00802544*(c8(+1))^-gamma+ 0.00004976*(c12(+1))^-gamma); % equation 12
c5 = 0.37416718*w + (1+r)*at5-a5+ TT; % equation 13
at5 = 10^-10 + 0.00002314*a7(-1)+ 0.00955186*a8(-1)+ 0.98085000*a9(-1)+ 0.00955186*a10(-1)+ 0.00002314*a11(-1); % equation 14
0.70168236*(c5 - 0)^-gamma =-0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00478739*(c2(+1))^-gamma+ 0.52603191*(c4(+1))^-gamma+ 0.00802544*(c8(+1))^-gamma+ 0.00004976*(c12(+1))^-gamma); % equation 15
c6 = 0.37416718*w + (1+r)*at6-a6+ TT; % equation 16
at6 = 10^-10 + 0.00007011*a12(-1)+ 0.01439730*a13(-1)+ 0.98078000*a14(-1)+ 0.00475259*a15(-1); % equation 17
1.07499165*(c6 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00478739*(c2(+1))^-gamma+ 0.52603191*(c4(+1))^-gamma+ 0.00802544*(c8(+1))^-gamma+ 0.00004976*(c12(+1))^-gamma); % equation 18
c7 = 0.77332146*w + (1+r)*at7-a7+ TT; % equation 19
at7 = 10^-10 + 0.98071024*a1(-1)+ 0.01928976*a2(-1); % equation 20
0.52579612*(c7 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00671861*(c5(+1))^-gamma+ 0.63307748*(c9(+1))^-gamma+ 0.00737431*(c13(+1))^-gamma); % equation 21
c8 = 0.77332146*w + (1+r)*at8-a8+ TT; % equation 22
at8 = 10^-10 + 0.00475259*a3(-1)+ 0.98078000*a4(-1)+ 0.01439730*a5(-1)+ 0.00007011*a6(-1); % equation 23
0.55877768*(c8 - 0)^-gamma =-0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00671861*(c5(+1))^-gamma+ 0.63307748*(c9(+1))^-gamma+ 0.00737431*(c13(+1))^-gamma); % equation 24
c9 = 0.77332146*w + (1+r)*at9-a9+ TT; % equation 25
at9 = 10^-10 + 0.00002314*a7(-1)+ 0.00955186*a8(-1)+ 0.98085000*a9(-1)+ 0.00955186*a10(-1)+ 0.00002314*a11(-1); % equation 26
0.64543761*(c9 - 0)^-gamma =-0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00671861*(c5(+1))^-gamma+ 0.63307748*(c9(+1))^-gamma+ 0.00737431*(c13(+1))^-gamma); % equation 27
c10 = 0.77332146*w + (1+r)*at10-a10+ TT; % equation 28
at10 = 10^-10 + 0.00007011*a12(-1)+ 0.01439730*a13(-1)+ 0.98078000*a14(-1)+ 0.00475259*a15(-1); % equation 29
0.86341748*(c10 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00671861*(c5(+1))^-gamma+ 0.63307748*(c9(+1))^-gamma+ 0.00737431*(c13(+1))^-gamma); % equation 30
c11 = 0.77332146*w + (1+r)*at11-a11+ TT; % equation 31
at11 = 10^-10 + 0.01928976*a16(-1)+ 0.98071024*a17(-1); % equation 32
1.29585445*(c11 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00671861*(c5(+1))^-gamma+ 0.63307748*(c9(+1))^-gamma+ 0.00737431*(c13(+1))^-gamma); % equation 33
c12 = 1.59828578*w + (1+r)*at12-a12+ TT; % equation 34
at12 = 10^-10 + 0.00475259*a3(-1)+ 0.98078000*a4(-1)+ 0.01439730*a5(-1)+ 0.00007011*a6(-1); % equation 35
0.70980573*(c12 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00007537*(c6(+1))^-gamma+ 0.01240083*(c10(+1))^-gamma+ 0.91152873*(c14(+1))^-gamma+ 0.00562809*(c16(+1))^-gamma); % equation 36
c13 = 1.59828578*w + (1+r)*at13-a13+ TT; % equation 37
at13 = 10^-10 + 0.00002314*a7(-1)+ 0.00955186*a8(-1)+ 0.98085000*a9(-1)+ 0.00955186*a10(-1)+ 0.00002314*a11(-1); % equation 38
0.77016268*(c13 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00007537*(c6(+1))^-gamma+ 0.01240083*(c10(+1))^-gamma+ 0.91152873*(c14(+1))^-gamma+ 0.00562809*(c16(+1))^-gamma); % equation 39
c14 = 1.59828578*w + (1+r)*at14-a14+ TT; % equation 40
at14 = 10^-10 + 0.00007011*a12(-1)+ 0.01439730*a13(-1)+ 0.98078000*a14(-1)+ 0.00475259*a15(-1); % equation 41
0.92939163*(c14 - 0)^-gamma =-0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00007537*(c6(+1))^-gamma+ 0.01240083*(c10(+1))^-gamma+ 0.91152873*(c14(+1))^-gamma+ 0.00562809*(c16(+1))^-gamma); % equation 42
c15 = 1.59828578*w + (1+r)*at15-a15+ TT; % equation 43
at15 = 10^-10 + 0.01928976*a16(-1)+ 0.98071024*a17(-1); % equation 44
1.25723502*(c15 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00007537*(c6(+1))^-gamma+ 0.01240083*(c10(+1))^-gamma+ 0.91152873*(c14(+1))^-gamma+ 0.00562809*(c16(+1))^-gamma); % equation 45
c16 = 3.30330603*w + (1+r)*at16-a16+ TT; % equation 46
at16 = 10^-10 + 0.00007011*a12(-1)+ 0.01439730*a13(-1)+ 0.98078000*a14(-1)+ 0.00475259*a15(-1); % equation 47
1.17560819*(c16 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00018170*(c11(+1))^-gamma+ 0.02407548*(c15(+1))^-gamma+ 1.42199333*(c17(+1))^-gamma); % equation 48
c17 = 3.30330603*w + (1+r)*at17-a17+ TT; % equation 49
at17 = 10^-10 + 0.01928976*a16(-1)+ 0.98071024*a17(-1); % equation 50
1.44996277*(c17 - 0)^-gamma =0.00000000 + beta*(1+r(+1))*(10^-10+ 0.00018170*(c11(+1))^-gamma+ 0.02407548*(c15(+1))^-gamma+ 1.42199333*(c17(+1))^-gamma); % equation 51
GDP -delta*K(-1) = TT +r*A(-1) + w; % equation 52
w = (1 - alpha)*(Z^(1/(1-alpha)))*((r + delta)/alpha)^(alpha/(alpha-1)); % equation 53
(r + delta)/(alpha*Z) = (K/1)^(alpha-1); % equation 54
Z = 1 + u; % equation 55
u = rho_u*u(-1) + eps; % equation 56
GDP = Z*K(-1)^alpha*1^(1-alpha); % equation 57
A = K; % equation 58

C =+0.06084884*c1+0.00119685*c2+0.00118815*c3+0.24519501*c4+0.00359933*c5
+0.00001753*c6+0.00000870*c7+0.00359063*c8+0.36870997*c9+0.00359063*c10
+0.00000870*c11+0.00001753*c12+0.00359933*c13+0.24519501*c14+0.00118815*c15
+0.00119685*c16+0.06084884*c17; % equation 59

W =+0.06084884*0.98550676*(((c1)^(1- gamma) -1)/(1-gamma) + 10)+0.00119685*0.97970075*(((c2)^(1- gamma) -1)/(1-gamma) + 10)+0.00118815*0.99462806*(((c3)^(1- gamma) -1)/(1-gamma) + 10)+0.24519501*0.99174378*(((c4)^(1- gamma) -1)/(1-gamma) + 10)+0.00359933*0.98971903*(((c5)^(1- gamma) -1)/(1-gamma) + 10)
+0.00001753*0.99125595*(((c6)^(1- gamma) -1)/(1-gamma) + 10)+0.00000870*0.99844127*(((c7)^(1- gamma) -1)/(1-gamma) + 10)+0.00359063*0.99734342*(((c8)^(1- gamma) -1)/(1-gamma) + 10)+0.36870997*0.99572343*(((c9)^(1- gamma) -1)/(1-gamma) + 10)+0.00359063*0.99515262*(((c10)^(1- gamma) -1)/(1-gamma) + 10)
+0.00000870*0.99552179*(((c11)^(1- gamma) -1)/(1-gamma) + 10)+0.00001753*0.99906472*(((c12)^(1- gamma) -1)/(1-gamma) + 10)+0.00359933*0.99830061*(((c13)^(1- gamma) -1)/(1-gamma) + 10)+0.24519501*0.99761975*(((c14)^(1- gamma) -1)/(1-gamma) + 10)+0.00118815*0.99734771*(((c15)^(1- gamma) -1)/(1-gamma) + 10)
+0.00119685*0.99895787*(((c16)^(1- gamma) -1)/(1-gamma) + 10)+0.06084884*0.99863680*(((c17)^(1- gamma) -1)/(1-gamma) + 10); % equation 60
I =  K(+1) - ( 1 - delta)*K; % equation 61

#Cba =(+0.00118815*c3+0.06084884*c1+0.00000870*c7+0.00119685*c2+0.00001753*c12+0.00359063*c8); % equation 62
#ba = +0.00118815*1+0.06084884*1+0.00000870*1+0.00119685*1+0.00001753*1+0.00359063*1; % equation 63

Cb = Cba/ba; % equation 64
A = +0.06084884*a1+0.00119685*a2+0.00118815*a3+0.24519501*a4+0.00359933*a5+0.00001753*a6+0.00000870*a7+0.00359063*a8+0.36870997*a9+0.00359063*a10+0.00000870*a11+0.00001753*a12+0.00359933*a13+0.24519501*a14+0.00118815*a15+0.00119685*a16+0.06084884*a17; % equation 65
ut = 100*u; % equation 66
Kt = 100*(K/29.34475761-1); % equation 67
Ct = 100*(C/steady_state(C)-1); % equation 68
Cbt = 100*(Cb/0.62882550-1); % equation 69
wt = 100*(w/2.16018957-1); % equation 70
rt = 100*(r - 0.01640772); % equation 71
Zt = ut; % equation 72
GDPt = 100*(GDP/3.37528920-1); % equation 73
It = 100*(I/0.73361894-1); % equation 74
Wt = 100*(W-10.70521488); % equation 75

end;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

steady_state_model;

a1 = 4.65096038;
at1 = 4.72886727;
c1 = 0.54657465;
a2 = 8.68971451;
at2 = 8.82770079;
c2 = 0.67390657;
a3 = 4.65118352;
at3 = 4.72886727;
c3 = 0.96354573;
a4 = 8.68992019;
at4 = 8.82770079;
c4 = 1.09089511;
a5 = 19.39781094;
at5 = 19.69356809;
c5 = 1.42715582;
a6 = 48.76914553;
at6 = 49.33769274;
c6 = 2.18633850;
a7 = 4.70627341;
at7 = 4.72886727;
c7 = 1.77070476;
a8 = 8.76130011;
at8 = 8.82770079;
c8 = 1.88176412;
a9 = 19.51364309;
at9 = 19.69356809;
c9 = 2.17357258;
a10 = 48.91017704;
at10 = 49.33769274;
c10 = 2.90755591;
a11 = 113.73129891;
at11 = 114.54496481;
c11 = 4.36360905;
a12 = 9.26033336;
at12 = 8.82770079;
c12 = 3.16481018;
a13 = 20.03539936;
at13 = 19.69356809;
c13 = 3.43389564;
a14 = 49.45604627;
at14 = 49.33769274;
c14 = 4.14376600;
a15 = 114.27167503;
at15 = 114.54496481;
c15 = 5.60531225;
a16 = 50.98705362;
at16 = 49.33769274;
c16 = 6.29592560;
a17 = 115.79509583;
at17 = 114.54496481;
c17 = 7.76505839;
r = 0.01640772;
w = 2.16018957;
K = 29.34475761;
Z = 1;
A = 29.34475761;
u = 0;
GDP = 3.37528920;
I = 0.73361894;
C = 2.64280463;
Cb = 0.62882550;
TT = 0.00000000;
W = 10.70521488;
ut = 0;
Kt = 0;
Ct  = 0;
Cbt  = 0;
Cmt  = 0;
Ctt  = 0;
wt = 0;
rt = 0;
Zt = 0;
GDPt = 0;
It = 0;
Wt = 0;
end;

resid;

steady(nocheck);

check;

shocks;
 var eps; stderr 0.00312000;
 end;
options_.TeX=1;

stoch_simul (order=1,irf=200, periods=10000) ut Zt GDPt Ct Cbt Kt It Wt rt wt u Z GDP C Cb K I W r w;